<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/160.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/160.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/160.jpg">
  <link rel="mask-icon" href="/images/160.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rickiewoo.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="We were both young when I first saw you.">
<meta property="og:type" content="website">
<meta property="og:title" content="Rickie Woo&#39;s Wonder Land">
<meta property="og:url" content="http://rickiewoo.github.io/page/2/index.html">
<meta property="og:site_name" content="Rickie Woo&#39;s Wonder Land">
<meta property="og:description" content="We were both young when I first saw you.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Rickie Woo">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://rickiewoo.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Rickie Woo's Wonder Land</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta custom-logo">
      <div class="site-meta-headline">
        <a>
          <img class="custom-logo-image" src="/images/logo.png" alt="Rickie Woo's Wonder Land">
        </a>
      </div>

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Rickie Woo's Wonder Land</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Why is a raven like a writing-desk?</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rickiewoo.github.io/2021/04/20/Redux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/sasuke.jpeg">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="We were both young when I first saw you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rickie Woo's Wonder Land">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/20/Redux/" class="post-title-link" itemprop="url">Redux 学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-20 18:15:10" itemprop="dateCreated datePublished" datetime="2021-04-20T18:15:10+08:00">2021-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-09 22:25:23" itemprop="dateModified" datetime="2022-08-09T22:25:23+08:00">2022-08-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/keep-learning/" itemprop="url" rel="index"><span itemprop="name">keep-learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h1><p>redux is powerful：redux可以追踪每一个变化背后的行为。</p>
<p><img src="https://miro.medium.com/max/825/1*N62EZSeQNHtwVumCQOdU-Q.png" alt="img"></p>
<h2 id="Redux与Flux"><a href="#Redux与Flux" class="headerlink" title="Redux与Flux"></a>Redux与Flux</h2><p><img src="https://user-gold-cdn.xitu.io/2019/3/24/169ad99f6092e26b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="123"></p>
<p>Redux受到了Flux架构的启发，但在实现上有一些不同：</p>
<ul>
<li>Redux并没有 dispatcher。它依赖纯函数来替代事件处理器，也不需要额外的实体来管理它们。Flux尝尝被表述为：<code>(state, action) =&gt; state</code>，而纯函数也是实现了这一思想。</li>
<li>Redux为不可变数据集。在每次Action请求触发以后，Redux都会生成一个新的对象来更新State，而不是在当前状态上进行更改。</li>
<li>Redux有且只有一个Store对象。它的Store储存了整个应用程序的State。</li>
</ul>
<h2 id="术语及概念"><a href="#术语及概念" class="headerlink" title="术语及概念"></a>术语及概念</h2><h3 id="不变性"><a href="#不变性" class="headerlink" title="不变性"></a>不变性</h3><p>redux期望所有值的更新都是不变的，也就是说对于引用类型，我们需要复制deep原变量并在此基础上做更改。</p>
<h3 id="redux中的数据流"><a href="#redux中的数据流" class="headerlink" title="redux中的数据流"></a>redux中的数据流</h3><ul>
<li>init<ul>
<li>使用root reducer函数创建一个store</li>
<li>store调用一次reducer，并保存它的返回值作为自己的初始state</li>
<li>当UI初次渲染时，UI组件会访问store中当前的state，并使用里面的数据决定渲染什么。他们也会订阅store中任何未来的的更改来知道state是否发生了变化。</li>
</ul>
</li>
<li>updates<ul>
<li>一些事件发生，比如用户点击一个按钮</li>
<li>app代码派发一个行为到store，比如<code>dispatch(&#123;type: &#39;counter/increment&#39;&#125;)</code></li>
<li>store再次运行reducer的function，使用上一个state和当前action，并保存返回值作为新的state</li>
<li>store通知所有订阅store的UI：store已经更新了</li>
<li>每一个从store中获取数据的UI组件检查他们需要的这部分数据是否发生变化</li>
<li>每个看到其数据已更改的组件都会强制使用新数据重新渲染，因此它可以更新屏幕上显示的内容</li>
</ul>
</li>
</ul>
<!-- ![Redux data flow diagram](https://redux.js.org/assets/images/ReduxDataFlowDiagram-49fa8c3968371d9ef6f2a1486bd40a26.gif) -->

<h3 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. plain object</span></span><br><span class="line"><span class="comment">// 2. has a type</span></span><br><span class="line"><span class="comment">// 3. whatever else you want</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">type</span>: <span class="string">&quot;USER_LOGGED_IN&quot;</span>,</span><br><span class="line">  username: <span class="string">&quot;rickieWoo&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>action是具有type属性的普通对象</p>
<h3 id="action-creators"><a href="#action-creators" class="headerlink" title="action creators"></a>action creators</h3><p>而且，由于总是手动编写这些对象会很烦人（更不用说容易出错），因此Redux具有“action creators”的概念，可以将这些内容淘汰掉</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">userLoggedIn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="keyword">type</span>: <span class="string">&#x27;USER_LOGGED_IN&#x27;</span>,</span><br><span class="line">    username: <span class="string">&#x27;dave&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Redux-toolKit"><a href="#Redux-toolKit" class="headerlink" title="Redux toolKit"></a>Redux toolKit</h2><p>Immer library？</p>
<p>将变更检测存为草稿状态（draft state）并基于这些变更产生一个全新的不可变状态</p>
<p>⬆️在RTK中，reduder中的state是草稿state</p>
<h3 id="Thunk"><a href="#Thunk" class="headerlink" title="Thunk"></a>Thunk</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://daveceddia.com/what-is-a-thunk/">https://daveceddia.com/what-is-a-thunk/</a></p>
</blockquote>
<p>thunk是function的另一种说法，不过thunk特指返回一个function的function。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wrapper_function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// this one is a &quot;thunk&quot; because it defers work for later:</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">thunk</span>(<span class="params"></span>) </span>&#123;   <span class="comment">// it can be named, or anonymous</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;do stuff now&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rickiewoo.github.io/2020/08/23/Flux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/sasuke.jpeg">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="We were both young when I first saw you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rickie Woo's Wonder Land">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/23/Flux/" class="post-title-link" itemprop="url">Flux学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-23 18:18:12" itemprop="dateCreated datePublished" datetime="2020-08-23T18:18:12+08:00">2020-08-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-09 22:23:48" itemprop="dateModified" datetime="2022-08-09T22:23:48+08:00">2022-08-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/keep-learning/" itemprop="url" rel="index"><span itemprop="name">keep-learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Flux"><a href="#Flux" class="headerlink" title="Flux"></a>Flux</h1><p>##concepts</p>
<p><img src="https://github.com/facebook/flux/raw/master/examples/flux-concepts/flux-simple-f8-diagram-with-client-action-1300w.png" alt="Data flow within Flux application"></p>
<p>Flux是一种管理应用中数据流的模式。最重要的观点是单向数据流。</p>
<p>Flux由Dispatcher、store、view、action构成</p>
<h3 id="Dispatcher"><a href="#Dispatcher" class="headerlink" title="Dispatcher"></a>Dispatcher</h3><p><code>dispatcher</code>接收<code>action</code>并把它们派发给已经在<code>disipatcher</code>中注册过的<code>store</code>。**每一个<code>store</code>都会收到所有<code>action</code>**。在每一个应用中应该只有一个单例<code>dispatcher</code>.</p>
<h3 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h3><p><code>store</code>存储了一个应用的数据。<code>store</code>通过注册到应用程序的<code>dispatcher</code>上接受<code>action</code>。一个<code>store</code>中的所有数据都只能因为响应行为发生变化。在一个<code>store</code>中只能有<code>getter</code>，不能有任何<code>public setter</code>，<code>store</code>决定了他们要响应什么<code>action</code>，每次一个<code>store</code>的数据变化必须<code>emit</code>一个<code>change event</code>。在一个应用程序中会有多个<code>store</code></p>
<h3 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h3><p>Actions 定义了应用程序内部的API，他们捕获应用程序内所有的交互，他们是简单的包含type字段和一些数据的对象</p>
<p>Actions应该是语义化的，描述所发生的action，但是不应该描述该action的实现细节。使用“删除用户”而不是将其分解为“删除用户ID”，“清除用户数据”，“刷新凭证”（或者该过程有效）。请记住，所有存储都将收到该操作，并且可以知道它们需要通过处理相同的“删除用户”操作来清除数据或刷新凭据。</p>
<h3 id="Views"><a href="#Views" class="headerlink" title="Views"></a>Views</h3><p>store中的数据会被称现在view追踪，views可以使用任何框架，例如react。当一个view使用了来自某个store的数据，他必须订阅来自那个store的change事件。然后当store出发一个change事件时，view可以得到新的数据并重新渲染。如果一个组件使用了一个store，但是并没有订阅，很可能会有细微的错误。当用户与应用程序界面的各个部分进行交互时，通常会从视图view中调度action。</p>
<h3 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h3><ol>
<li>view发送action到dsipatcher</li>
<li>dispatcher发送action到每一个store</li>
<li>store发送数据到view</li>
</ol>
<p>（是store主动发送数据到view，而不是view从store获取数据）</p>
<h2 id="flux-async"><a href="#flux-async" class="headerlink" title="flux-async"></a>flux-async</h2><h3 id="DataManager"><a href="#DataManager" class="headerlink" title="DataManager"></a>DataManager</h3><p>DataManagers是flex中服务器痛心的方法，DataManagers将入参转化为action，作为结果的action应始终被异步调度，这样可以在调度该action的之前留出API请求的时间。</p>
<p>DataManagers只应该被store调用。</p>
<p>TODO</p>
<ul>
<li>flux的缺点<ul>
<li>多个store有什么优缺点</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rickiewoo.github.io/2020/05/23/InnerHtml%20InnerText%20And%20TextcCntent/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/sasuke.jpeg">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="We were both young when I first saw you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rickie Woo's Wonder Land">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/23/InnerHtml%20InnerText%20And%20TextcCntent/" class="post-title-link" itemprop="url">InnerHtml InnerText And TextcCntent</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-05-23 18:18:12" itemprop="dateCreated datePublished" datetime="2020-05-23T18:18:12+08:00">2020-05-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-09 22:23:54" itemprop="dateModified" datetime="2022-08-09T22:23:54+08:00">2022-08-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index"><span itemprop="name">note</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="InnerHtml-InnerText-And-TextContent"><a href="#InnerHtml-InnerText-And-TextContent" class="headerlink" title="InnerHtml InnerText And TextContent"></a>InnerHtml InnerText And TextContent</h3><p>在js中，有三种方式设置/得到DOM中HTML元素的内容</p>
<h4 id="InnerHtml"><a href="#InnerHtml" class="headerlink" title="InnerHtml"></a>InnerHtml</h4><p>设置/返回一个元素content，以新的HTML形式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> example = <span class="built_in">document</span>.getElementById(‘example’)</span><br><span class="line">example.innerHTML = “&lt;p&gt;This is &lt;strong&gt;my&lt;<span class="regexp">/strong&gt; paragraph.&lt;/</span>p&gt;”</span><br></pre></td></tr></table></figure>



<p>HTML5禁止在innerHtml中包含script标签，因为会产生XSS脚本攻击这类安全问题。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***以下alert将不会显示***/</span></span><br><span class="line"><span class="keyword">const</span> example1 = <span class="string">&quot;&lt;script&gt;alert(&#x27;I am an annoying alert!&#x27;)&lt;/script&gt;&quot;</span></span><br><span class="line">el.innerHTML = example1</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> example2 = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;example2&#x27;</span>)</span><br><span class="line">example2.innerHTML = <span class="string">&#x27;&lt;script deferred&gt;alert(&quot;XSS Attack&quot;);&lt;/script&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/***以下将产生脚本注入的网络问题***/</span></span><br><span class="line"><span class="keyword">const</span> example3 = <span class="string">&quot;&lt;img src=&#x27;x&#x27; onerror=&quot;</span>alert(<span class="number">1</span>)<span class="string">&quot;</span></span><br><span class="line"><span class="string">const example4 = &#x27;&lt;img src=x onerror=&quot;</span>alert(\<span class="string">&#x27;XSS Attack\&#x27;)&quot;&gt;&#x27;</span></span><br><span class="line"><span class="keyword">const</span> example5 = <span class="string">&#x27;&lt;img src=&quot;urlNotExist&quot; onerror=&quot;alert(document.cookie)&quot;&gt;&#x27;</span></span><br><span class="line"><span class="keyword">const</span> example5 = <span class="string">&#x27;&lt;img src=x onerror=&quot;alert(\&#x27;XSS Attack\&#x27;)&quot;&gt;&#x27;</span></span><br><span class="line">&lt;button onmouseover=alert(<span class="string">&#x27;Wufff!&#x27;</span>)&gt;click me!&lt;/button&gt;</span><br><span class="line">&lt;img src=j&amp;#X41vascript:alert(<span class="string">&#x27;test2&#x27;</span>)&gt;</span><br></pre></td></tr></table></figure>



<h4 id="innerText"><a href="#innerText" class="headerlink" title="innerText"></a>innerText</h4><p>返回内部除了script标签和style标签以外的所有元素的内容，返回的内容是可见的文本，并没有任何的格式化。(注意不会显示HTML代码中多余的空格)</p>
<p>缺点：innerText会触发浏览器的重排（reflow），因为他是css层面的概念，这将会导致性能下降。</p>
<p>reflow指的是浏览器重新计算页面元素及重新呈现文档时会出现的。触发reflow的例子包括调整浏览器的窗口大小或者更改DOM中的元素。这种计算是昂贵的，所以应该将其最小化以提高速度、效率及用户体验。</p>
<h4 id="textContent"><a href="#textContent" class="headerlink" title="textContent"></a>textContent</h4><p>textContent将返回所有原始内容，不包括HTML标签。因此返回的值包括空格、换行符、回车符、script和style元素的内容等。与innerHTML不同的是，它具有更好的性能，因为他的值没有被解析为html，因此不会有XSS攻击的问题；与innerText相比，由于它与css无关，所以不会出发reflow。所有的node对象都有textConetnt，但是只有HTMLElement对象有innerText。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rickiewoo.github.io/2020/04/23/js-%E5%85%B3%E4%BA%8E%E6%95%B0%E5%AD%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/sasuke.jpeg">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="We were both young when I first saw you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rickie Woo's Wonder Land">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/23/js-%E5%85%B3%E4%BA%8E%E6%95%B0%E5%AD%97/" class="post-title-link" itemprop="url">js-关于数字</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-23 18:18:12" itemprop="dateCreated datePublished" datetime="2020-04-23T18:18:12+08:00">2020-04-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-09 22:24:18" itemprop="dateModified" datetime="2022-08-09T22:24:18+08:00">2022-08-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index"><span itemprop="name">note</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="js-关于数字"><a href="#js-关于数字" class="headerlink" title="js-关于数字"></a>js-关于数字</h1><h4 id="浮点数转整数"><a href="#浮点数转整数" class="headerlink" title="浮点数转整数"></a>浮点数转整数</h4><ul>
<li>Math.floor()： 向下取整</li>
<li>Math.ceil(): 向上取整</li>
<li>Math.trunc(): 去掉小数点</li>
<li>Math.round(): 四舍五入</li>
</ul>
<p>####Infinity:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">Infinity</span> === <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">-<span class="literal">Infinity</span> === <span class="built_in">Math</span>.log(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">-<span class="built_in">Math</span>.log(<span class="number">0</span>) === <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> / <span class="literal">Infinity</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure>



<p>####Array.flat()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>]];</span><br><span class="line">arr.flat(); <span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>, [<span class="number">5</span>]]]];</span><br><span class="line">arr.flat(<span class="number">2</span>); <span class="comment">// [1, 2, 3, 4, [5]]</span></span><br><span class="line"><span class="comment">// 平铺数组</span></span><br><span class="line">arr.flat(<span class="literal">Infinity</span>)</span><br></pre></td></tr></table></figure>



<h4 id="Date：Add-days"><a href="#Date：Add-days" class="headerlink" title="Date：Add days"></a>Date：Add days</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> result = <span class="keyword">new</span> <span class="built_in">Date</span>(date)</span><br><span class="line">result.setDate(result.getDate() + days)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rickiewoo.github.io/2020/04/20/RxJS%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/sasuke.jpeg">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="We were both young when I first saw you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rickie Woo's Wonder Land">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/20/RxJS%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">RxJS基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-20 18:15:10" itemprop="dateCreated datePublished" datetime="2020-04-20T18:15:10+08:00">2020-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-09 22:25:36" itemprop="dateModified" datetime="2022-08-09T22:25:36+08:00">2022-08-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/keep-learning/" itemprop="url" rel="index"><span itemprop="name">keep-learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="RxJS基础"><a href="#RxJS基础" class="headerlink" title="RxJS基础"></a>RxJS基础</h3><ul>
<li>命名：使用芬兰式命名法，流的变量以$结尾</li>
<li>RxJS 应用了两种重要的编程思想<ul>
<li>函数式</li>
<li>响应式</li>
</ul>
</li>
</ul>
<h4 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h4><h5 id="函数式编程的要求"><a href="#函数式编程的要求" class="headerlink" title="函数式编程的要求"></a>函数式编程的要求</h5><ul>
<li>声明式</li>
<li>纯函数</li>
<li>数据不可变性</li>
</ul>
<p>传统上讲，JS并不是一门纯粹的函数式编程语言，但是函数是JS的一等公民，因为函数是一个对象，可以作为参数被赋值给一个变量，也可以作为参数传递。因此可以应用函数式编程思想中的许多东西。</p>
<h5 id="声明式编程-vs-命令式编程"><a href="#声明式编程-vs-命令式编程" class="headerlink" title="声明式编程 vs 命令式编程"></a>声明式编程 vs 命令式编程</h5><p>与声明式编程相对应的编程方式就是命令式编程。</p>
<p>二者的主要区别是，声明式编程更关注What，而命令式更关注How，在命令式编程中可能存在一个很大的问题就是重复的代码，因为它更关注详细的过程。</p>
<h5 id="纯函数"><a href="#纯函数" class="headerlink" title="纯函数"></a>纯函数</h5><p>纯函数的主要满足以下两个条件，满足纯函数的特性也叫做引用透明度（referential transparency）</p>
<ol>
<li>函数的执行过程完全由入参决定，不会受其他任何数据的影响。</li>
<li>函数不会修改外部状态</li>
</ol>
<blockquote>
<p>比如JS中的String.split()， 会返回一个新数组，但是不会修改原来的字符串，也不会影响其他变量，这就是个纯函数</p>
<p>而Array.splice()会修改第一个入参，并返回该入参，就不是一个纯函数</p>
</blockquote>
<p>与纯函数相对的就是不纯函数，不纯函数包括但不仅限于以下几个特点</p>
<ol>
<li>网络输入、输出操作</li>
<li>操作浏览器的DOM</li>
<li>读取用户的输入</li>
<li>抛出一个异常</li>
<li>改变全局变量的值，改变输入参数引用的对象</li>
</ol>
<p>其中前四条是比较容易忽略的，实际上判断一个函数纯不纯的方法，就是看讲一个函数调用替换为一个预期返回的常数，看程序的运行结果是否一样（说明不依赖或改变外部参数）</p>
<h5 id="数据的不可变性（Immutable）"><a href="#数据的不可变性（Immutable）" class="headerlink" title="数据的不可变性（Immutable）"></a>数据的不可变性（Immutable）</h5><p>当我们需要数据发生改变的时候，保持原有数据不变，产生一个新的数据来体现这种变化。</p>
<p>注意：在JS中const关键字虽然有常数的意思，但其实只是规定一个变量引用的对象不能改变，没有规定这个对象本身不能改变，因此这个常量依然是变量</p>
<h5 id="函数式编程与面向对象编程"><a href="#函数式编程与面向对象编程" class="headerlink" title="函数式编程与面向对象编程"></a>函数式编程与面向对象编程</h5><p>面向对象编程是将状态的改变封装起来以达到使代码更加简洁，并复用部分代码的目的。而函数式编程是尽量减少变化的部分，使代码逻辑更清晰。</p>
<p>面向对象的思想是把数据封装在一个类的实例对象中，外部不能直接操作这些数据，只能通过类提供的一些实例方法读取和修改这些数据，这就限制了对数据的访问方式。这样就会有一个缺陷，就是数据的修改历史完全被隐藏了。</p>
<p>当我们在代码中看到一个对象实例的时候，即使知道了对象当前的状态，也没法知道对象是如何一步步走到这状态的，这种不确定性导致代码的可维护性下降。</p>
<p>在函数式白岸城中，倾向于数据与方法分开，函数可以处理数据，但是是作为纯函数产生新的数据，也就是不改变原有的数据（数据的不可变性）</p>
<h5 id="函数响应式编程"><a href="#函数响应式编程" class="headerlink" title="函数响应式编程"></a>函数响应式编程</h5><p>优势： 不用关心数据是同步产生的还是异步产生的</p>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><h5 id="深链式导入相应模块"><a href="#深链式导入相应模块" class="headerlink" title="深链式导入相应模块"></a>深链式导入相应模块</h5><h6 id="Tree-Shaking"><a href="#Tree-Shaking" class="headerlink" title="Tree-Shaking"></a>Tree-Shaking</h6><p>在JS的打包工具中，有一个功能叫Tree-Shaking，指在打包过程中发现没有被引用过的函数，在最终的打包文件中就不会包含这些无用的函数代码。</p>
<p>值得注意的是，Tree-Shaking只对import语句的导入产生作用，对于CommonJS的require函数导入方式不起作用。因为Tree-Shaking的工作方式是对代码进行静态分析，import只能出现在代码第一层，被导入的模块以字符串常量出现，因此满足静态分析的需要。而require还可以出现在条件分支语句中，参数也可以是动态产生的字符串，所以只有在动态执行的时候才知道require函数如何执行，因此Tree-Shaking不会分析到它。</p>
<p>那么RxJS为什么要用深链式导入模块呢，Tree-Shaking为什么对它不起作用呢？</p>
<p>这是因为在RxJs中的大部分函数都是围绕一个Observable类创建的，这些功能都体现为这个类的一个函数，并挂在这个Observable上。也就是说这些函数在内部已经被Observable这个类引用了。</p>
<ul>
<li>在node_modules/rxjs/Rx.hs中会发现功能模块都是被require进去的</li>
<li>在某一个js文件中（如of），可以发现是先require获得Observable类，然后在Observable上添加一个类函数（如of），那么Observable.of就成为了一个函数，of被引用了，因此最终打包文件会包含of。</li>
</ul>
<p>因此，使用RxJS需要按需导入，采用deep-link的方式。不过更好的方式是，<em>用一个代码文件专门导入RxJS相关的功能，其他的代码文件再导入这个文件，这样就能把RxJS导入的工作做集中管理</em>。</p>
<h4 id="Observer-和-Observable"><a href="#Observer-和-Observable" class="headerlink" title="Observer 和 Observable"></a>Observer 和 Observable</h4><p>RxJS的运行就是Observer和Observable之间的互动游戏</p>
<ul>
<li>Observable：可被观察的对象，在RxJS中就是数据流</li>
<li>Observer：观察者</li>
<li>subscribe：连接二者的桥梁</li>
</ul>
<p>Observable实现了两种模式</p>
<ul>
<li>观察者模式</li>
<li>迭代器模式</li>
</ul>
<h5 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h5><p>将逻辑分为发布者和观察者，发布者只管产生数据，观察者负责处理产生的数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> source$ = Observable.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">$source.subscribe(<span class="built_in">console</span>.log))</span><br></pre></td></tr></table></figure>

<p>Observable负责发布者的责任，产生事件</p>
<p>subscribe的参数负责观察者的责任，响应事件</p>
<p>何时调用subscribe，发布者与观察者之间的关联状态</p>
<h5 id="迭代器模式"><a href="#迭代器模式" class="headerlink" title="迭代器模式"></a>迭代器模式</h5><p>迭代器：能够遍历一个数据集合的对象。通常包含</p>
<ul>
<li>getCurrent；获取当前游标所指向的元素</li>
<li>moveToNext：将游标移动到下一个元素</li>
<li>isDone：是否已经遍历完所有元素</li>
</ul>
<p>而在RxJS中似乎看不到这样的代码，那是因为RxJS中的数据是推来的，而不是拉。这就是迭代器模式和观察者模式的结合。</p>
<h4 id="创造Observable"><a href="#创造Observable" class="headerlink" title="创造Observable"></a>创造Observable</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> onSubscribe = <span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// observer为观察者的一个代理，而非观察者本身</span></span><br><span class="line">  <span class="comment">// 因此在该观察者完成后，不会再执行下一句error</span></span><br><span class="line">  observer.next(<span class="number">1</span>);</span><br><span class="line">  observer.next(<span class="number">2</span>);</span><br><span class="line">  observer.next(<span class="number">3</span>);</span><br><span class="line">  observer.complete();</span><br><span class="line">  observer.error(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> source$ = <span class="keyword">new</span> Observable(onSubscrbe)</span><br><span class="line"><span class="comment">// Observable 是一个特殊的类，接收一个处理observer的函（发出数据）</span></span><br><span class="line"><span class="keyword">const</span> theObserver = &#123;</span><br><span class="line">  next: <span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 一个必须包含next属性的对象，next方法用于处理推来的数据</span></span><br><span class="line">source$.subscribe(theObserver)</span><br></pre></td></tr></table></figure>

<h4 id="Observable的完结"><a href="#Observable的完结" class="headerlink" title="Observable的完结"></a>Observable的完结</h4><p>Observable的complete方法何时被调用完全取决于observable的行为，即onSubscribe函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> theObserver = &#123;</span><br><span class="line">  next: <span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">console</span>.log(item);</span><br><span class="line">  complete: <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;no more data&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> onSubscribe = <span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> number = <span class="number">1</span></span><br><span class="line">  <span class="keyword">const</span> handle = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    observable.next(number++)</span><br><span class="line">    <span class="keyword">if</span> (number &gt; <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(handle)</span><br><span class="line">      observer.complete()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// no more data</span></span><br></pre></td></tr></table></figure>

<h4 id="Observable的出错"><a href="#Observable的出错" class="headerlink" title="Observable的出错"></a>Observable的出错</h4><p>一个Observable对象只有一个终结状态，要么是complete，要么是error</p>
<h4 id="退订Observable"><a href="#退订Observable" class="headerlink" title="退订Observable"></a>退订Observable</h4><p>其实，onSubscribe函数可以返回一个对象，对象上可以有一个unsubscribe函数，代表退订。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> onSubscribe = <span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> number = <span class="number">1</span></span><br><span class="line">  <span class="keyword">const</span> handle = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    observable.next(number++)</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    unsubscribe: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      clearIntervel(handle)</span><br><span class="line">		&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> subscription = source$.subscribe(<span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">console</span>.log(item))</span><br><span class="line">setTimeOut(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  subscription.unsbscribe()</span><br><span class="line">&#125;, <span class="number">3</span>)</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>虽然observer在退订之后不会再接收observable推来的数据，但是observable依旧可以推送数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> onSubscribe = <span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> number = <span class="number">1</span></span><br><span class="line">  <span class="keyword">const</span> handle = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;fromObservable&#x27;</span>, number)</span><br><span class="line">    observable.next(number++)</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    unsubscribe: <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> subscription = source$.subscribe(<span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">console</span>.log(item))</span><br><span class="line">setTimeOut(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  subscription.unsbscribe()</span><br><span class="line">&#125;, <span class="number">3</span>)</span><br><span class="line"><span class="comment">// fromObservable 1</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// fromObservable 2</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// fromObservable 3</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// fromObservable 4</span></span><br><span class="line"><span class="comment">// fromObservable 5</span></span><br><span class="line"><span class="comment">// ……</span></span><br></pre></td></tr></table></figure>

<h4 id="Hot-Observable-amp-Cold-Observable"><a href="#Hot-Observable-amp-Cold-Observable" class="headerlink" title="Hot Observable &amp; Cold Observable"></a>Hot Observable &amp; Cold Observable</h4><p>Hot: 错过了就错过了，只需要从订阅的那一刻开始Observable产生数据就行</p>
<p>Cold: 不能错过，需要获取observable之前产生的数据</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rickiewoo.github.io/2020/04/20/RxJs%20-%E6%93%8D%E4%BD%9C%E7%AC%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/sasuke.jpeg">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="We were both young when I first saw you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rickie Woo's Wonder Land">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/20/RxJs%20-%E6%93%8D%E4%BD%9C%E7%AC%A6/" class="post-title-link" itemprop="url">RxJS 学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-20 18:15:10" itemprop="dateCreated datePublished" datetime="2020-04-20T18:15:10+08:00">2020-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-09 22:25:29" itemprop="dateModified" datetime="2022-08-09T22:25:29+08:00">2022-08-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/keep-learning/" itemprop="url" rel="index"><span itemprop="name">keep-learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="RxJs-学习"><a href="#RxJs-学习" class="headerlink" title="RxJs 学习"></a>RxJs 学习</h1><h2 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h2><h3 id="操作符的分类"><a href="#操作符的分类" class="headerlink" title="操作符的分类"></a>操作符的分类</h3><ul>
<li>按功能分类<ul>
<li>创建类：of、from</li>
<li>转化类： map</li>
<li>过滤类：filter</li>
<li>合并类：merge，combineLatest，fork</li>
<li>错误处理类：catchError</li>
<li>多播类：publishReplay？</li>
<li>辅助工具类</li>
<li>条件分支类</li>
<li>数学和合计类</li>
<li>背压控制类：zip<ul>
<li>背压：发大水时，下游无法让水流即使通过，水流淤积，逐步把压力传递给上游，这种现象称为背压</li>
</ul>
</li>
<li>可连接类：connnect，全部和多播有关</li>
<li>高阶Observable<ul>
<li>指产生数据本身也是Observablele对象的Observable对象。</li>
</ul>
</li>
</ul>
</li>
<li>静态和实例分类：都返回一个 Obsevable对象<ul>
<li>静态：只能出现在首部，不需要Observable实例就可以执行的函数，如of<ul>
<li>Observable.of = functionOf</li>
</ul>
</li>
<li>实例：Obsevable的实例函数，前提是有一个创建好的observable对象，如map<ul>
<li>Observable.prototype.map = functionMap</li>
</ul>
</li>
<li>这两个形式没有本质区别，在链式调用的中间位置只能用实例函数形式的操作符</li>
</ul>
</li>
</ul>
<h3 id="操作符的实现"><a href="#操作符的实现" class="headerlink" title="操作符的实现"></a>操作符的实现</h3><p>每个操作符都是一个函数，实现一个操作符必须考虑以下几点</p>
<ul>
<li>返回一个全新的Observable对象</li>
<li>对上游和下游的订阅及退订<ul>
<li>当不需要从某一个observable获取数据的时候，就退订这个observable</li>
</ul>
</li>
<li>处理异常情况<ul>
<li>捕获异常的错误并将其传递给下游</li>
<li>将上游的异常传递给下游</li>
</ul>
</li>
<li>及时释放资源<ul>
<li>DOM操作要注意相关Observeable的及时释放</li>
<li>Websocket等也是</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">map</span>(<span class="params">project</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observbale(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 假设this是上游的observable</span></span><br><span class="line">    <span class="keyword">const</span> sub = <span class="built_in">this</span>.subscribe(&#123;</span><br><span class="line">      next: <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">          Observer.next(project(value))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">					Observer.error(e)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      error: <span class="function"><span class="params">error</span> =&gt;</span> Observer.error(error),</span><br><span class="line">      complete: <span class="function">() =&gt;</span> observer.complete()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 提供退订方法</span></span><br><span class="line">    unsubscribe: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      sub.unsubscribe()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="关联-Observable"><a href="#关联-Observable" class="headerlink" title="关联 Observable"></a>关联 Observable</h3><p>把上面的函数与 Observable 关联起来</p>
<p>####打补丁（会污染全局Observable</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Observable.prototypr.map = map</span><br></pre></td></tr></table></figure>

<p>####bind绑定特定 Observable 对象（无法使用链式调用</p>
<ul>
<li>缺点：无法使用链式调用（绑定操作符可解决问题，但是还未进入标准）</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使 map 中的 this 指向source$</span></span><br><span class="line"><span class="comment">// bind 产生一个新函数: map.bind(source$)</span></span><br><span class="line"><span class="keyword">const</span> result$ = map.bind(source$)(<span class="function"><span class="params">x</span> =&gt;</span> x*<span class="number">2</span>)</span><br><span class="line"><span class="comment">// call 立即执行原函数</span></span><br><span class="line"><span class="keyword">const</span> result$ = map.call(source$, <span class="function"><span class="params">x</span> =&gt;</span> x*<span class="number">2</span>)</span><br><span class="line"><span class="comment">// 连续使用两个 map</span></span><br><span class="line"><span class="keyword">const</span> result$ = map.bind(map.bind(source$)(<span class="function"><span class="params">x</span> =&gt;</span> x*<span class="number">2</span>))(<span class="function"><span class="params">x</span> =&gt;</span> x+<span class="number">1</span>)</span><br><span class="line"><span class="comment">// 绑定操作符链式调用</span></span><br><span class="line"><span class="keyword">const</span> result$ = source$:::map(<span class="function"><span class="params">x</span> =&gt;</span> x*<span class="number">2</span>)::map(<span class="function"><span class="params">x</span> =&gt;</span> x + <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="lift（应用层开发者很少使用"><a href="#lift（应用层开发者很少使用" class="headerlink" title="lift（应用层开发者很少使用"></a>lift（应用层开发者很少使用</h4><p>多是RxJs库的开发者使用，访问了this，违背了函数式编程的原则</p>
<figure class="h